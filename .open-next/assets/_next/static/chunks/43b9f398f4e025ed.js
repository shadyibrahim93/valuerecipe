(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,22736,e=>{"use strict";var s=e.i(91398),a=e.i(91788),t=e.i(94223),i=e.i(81302);function r(){let[e,r]=(0,a.useState)(""),[n,l]=(0,a.useState)([]),[c,u]=(0,a.useState)([]),[o,d]=(0,a.useState)(!1);return(0,a.useEffect)(()=>{n.length?async function(){d(!0);let e=n.join(","),s=await fetch(`/api/recipes?ingredients=${e}&match_type=all`);u((await s.json()).data||[]),d(!1)}():u([])},[n]),(0,s.jsxs)("section",{className:"vr-create-ing",children:[(0,s.jsx)("h2",{className:"vr-category__title",children:"Create Recipes From Ingredients"}),(0,s.jsx)("p",{className:"vr-modal-subtitle",children:"Add the ingredients you have, and weâ€™ll show you matching recipes."}),(0,s.jsxs)("div",{className:`${n.length>0?"vr-filter-container":""}`,children:[(0,s.jsxs)("form",{className:"vr-create-ing__input-row",onSubmit:function(s){s.preventDefault();let a=e.trim();if(!a)return;let t=a.toLowerCase().replace(/[^a-z0-9]+/g,"-");n.includes(t)||l([...n,t]),r("")},children:[(0,s.jsx)("input",{type:"text",placeholder:"Add ingredientsâ€¦",value:e,onChange:e=>r(e.target.value)}),(0,s.jsx)("button",{type:"submit",children:"Add"})]}),n.length>0&&(0,s.jsxs)("div",{className:"vr-create-ing__tags",children:[n.map(e=>(0,s.jsxs)("button",{className:"vr-create-ing__tag",onClick:()=>{l(n.filter(s=>s!==e))},type:"button",children:[e.replace(/-/g," ")," ",(0,s.jsx)("span",{children:"Ã—"})]},e)),(0,s.jsx)("button",{type:"button",className:"vr-create-ing__tag vr-create-ing__tag--clear",onClick:()=>l([]),children:"Clear All"})]})]}),o&&(0,s.jsx)("p",{children:"Loading recipesâ€¦"}),!o&&c.length>0&&(0,s.jsx)("div",{className:"vr-category__grid",children:c.map((e,a)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.default,{recipe:e},e.id),(a+1)%6==0&&(0,s.jsx)("article",{className:"vr-card vr-recipe-card vr-ad-card-wrapper",children:(0,s.jsx)(i.default,{id:"101",position:"in-feed",height:"100%"})})]}))})]})}e.s(["default",()=>r])},94118,e=>{"use strict";var s=e.i(91398),a=e.i(91788),t=e.i(58678),i=e.i(81586),r=e.i(92544),n=e.i(94223),l=e.i(12456),c=e.i(41158);function u({label:e="Add Favorite"}){return(0,s.jsx)(c.default,{href:"/",className:"vr-favorite-add",children:(0,s.jsxs)("div",{className:"vr-favorite-add__inner",children:[(0,s.jsx)("span",{className:"vr-favorite-add__plus",children:"+"}),(0,s.jsx)("p",{children:e})]})})}var o=e.i(22736),d=e.i(30142),h=e.i(67615);let m=[{name:"Favorites",slug:"favorites"},{name:"Christmas",slug:"christmas"},{name:"Thanksgiving",slug:"thanksgiving"}],p=["favorites","christmas","thanksgiving"];function g(){let{user:e,loading:c}=(0,r.useUser)(),[g,v]=(0,a.useState)("signin"),[_,f]=(0,a.useState)(""),[j,x]=(0,a.useState)(""),[b,y]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),[S,C]=(0,a.useState)(""),[P,A]=(0,a.useState)(""),[E,F]=(0,a.useState)(null),[k,R]=(0,a.useState)(""),[D,T]=(0,a.useState)(""),[$,U]=(0,a.useState)([]),[q,O]=(0,a.useState)(!0),[I,B]=(0,a.useState)([]),[M,Y]=(0,a.useState)(!0),[L,X]=(0,a.useState)({}),[J,K]=(0,a.useState)(!1),[z,H]=(0,a.useState)(!1),[W,G]=(0,a.useState)(e?.email||""),[Q,V]=(0,a.useState)(""),[Z,ee]=(0,a.useState)(""),es=async e=>{e.preventDefault(),y("");let{error:s}=await i.supabase.auth.signInWithPassword({email:_,password:j});s?y(s.message):y("Signed in successfully.")},ea=async e=>{e.preventDefault(),y("");let{data:s,error:a}=await i.supabase.auth.signUp({email:_,password:j,options:{data:{first_name:N,last_name:S,phone:P}}});if(a)return y(a.message);s.user&&await i.supabase.from("profiles").insert({id:s.user.id,first_name:N,last_name:S,phone:P}),y("Check your email to confirm your account.")},et=async e=>{e.preventDefault(),y("");let s=`${window.location.origin}/profile`,{error:a}=await i.supabase.auth.resetPasswordForEmail(_,{redirectTo:s});a?y(a.message):y("Password reset email sent.")},ei=async e=>{e.preventDefault(),T("");let{error:s}=await i.supabase.auth.updateUser({password:k});s?T(s.message):T("Password updated successfully.")},er=async()=>{await fetch("/api/newsletter/newsletter-unsubscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e.email})}),K(!1),G(e.email)},en=async e=>{e.preventDefault(),await fetch("/api/newsletter/newsletter-subscribe",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:W})}),V("ðŸŽ‰ You're subscribed again!"),K(!0)};(0,a.useEffect)(()=>{e&&s();async function s(){let{data:s}=await i.supabase.from("profiles").select("*").eq("id",e.id).single();F(s||null)}},[e]),(0,a.useEffect)(()=>{e&&s();async function s(){let s=await fetch(`/api/newsletter/newsletter-status?email=${e.email}`);K((await s.json()).subscribed),H(!0)}},[e]),(0,a.useEffect)(()=>{!async function(){let e=(0,l.getFavoriteIds)();if(0===e.length){U([]),O(!1);return}let s=await fetch(`/api/recipes?ids=${encodeURIComponent(e.join(","))}&per_page=${e.length}`);U((await s.json()).data||[]),O(!1)}()},[]),(0,a.useEffect)(()=>{e&&s();async function s(){Y(!0);let{data:s}=await i.supabase.from("user_collections").select("*").eq("user_id",e.id).order("created_at",{ascending:!0});s=s||[];let a=m.filter(e=>!s.some(s=>s.slug===e.slug));if(a.length>0){let{data:t}=await i.supabase.from("user_collections").insert(a.map(s=>({user_id:e.id,name:s.name,slug:s.slug,is_system:!0,recipes:[]}))).select();s=[...s,...t||[]]}(s=s.map(e=>({...e,recipes:Array.isArray(e.recipes)?e.recipes.map(e=>String(e)):[]}))).sort((e,s)=>{let a=p.indexOf(e.slug),t=p.indexOf(s.slug);return -1!==a&&-1!==t?a-t:-1!==a?-1:-1!==t?1:e.name.localeCompare(s.name)}),B(s),Y(!1)}},[e]),(0,a.useEffect)(()=>{I.length?async function(){let e={};for(let s of I){let a=Array.isArray(s.recipes)?s.recipes:[];if(!a.length){e[s.id]=[];continue}let t=await fetch(`/api/recipes?ids=${encodeURIComponent(a.join(","))}&per_page=${a.length}`),i=await t.json();e[s.id]=i.data||[]}X(e)}():X({})},[I]);let el=async()=>{if(!e||!confirm("Delete all your recipe categories?"))return;let{error:s}=await i.supabase.from("user_collections").delete().eq("user_id",e.id);s?ee(s.message):ee("Your collections have been deleted.")};return c||e?(0,s.jsxs)("div",{className:"vr-page",children:[(0,s.jsx)(t.default,{children:(0,s.jsxs)("title",{children:[d.BRAND_NAME," â€”"," ",E?.first_name+"'s"," ","Profile"]})}),(0,s.jsxs)("h1",{className:"vr-page__title",children:["Hello,"," ",E?.first_name||e?.user_metadata?.first_name||"Chef"]}),(0,s.jsxs)("div",{className:"vr-layout",children:[(0,s.jsxs)("div",{className:"vr-layout__main",children:[(0,s.jsx)("div",{className:"vr-card",children:(0,s.jsx)(o.default,{})}),!M&&I.map(e=>{let a=L[e.id]||[];return(0,s.jsxs)("section",{className:"vr-category vr-category--profile vr-card",children:[(0,s.jsx)("h2",{className:"vr-category__title",children:"Favorites"===e.name?"Favorite Recipes":`${e.name} Menu`}),(0,s.jsxs)("p",{className:"vr-category__subtitle",children:["Recipes saved to your â€œ",e.name,"â€ category."]}),(0,s.jsx)("div",{className:"vr-category__grid",children:0===a.length?(0,s.jsx)(u,{label:"Add Recipes"}):a.map(e=>(0,s.jsx)(n.default,{recipe:e},e.id))})]},e.id)}),(0,s.jsxs)("section",{className:"vr-category vr-category--profile vr-card",children:[(0,s.jsx)("h2",{className:"vr-category__title",children:"Account Settings"}),(0,s.jsxs)("form",{className:"vr-auth__form vr-auth__form--inline",onSubmit:ei,children:[(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Change Password"}),(0,s.jsx)("input",{type:"password",value:k,onChange:e=>R(e.target.value),placeholder:"New password"})]}),(0,s.jsx)("button",{className:"vr-auth__submit",type:"submit",children:"Update Password"})]}),D&&(0,s.jsx)("p",{className:"vr-auth__message",children:D}),(0,s.jsxs)("div",{className:"vr-account-actions",children:[(0,s.jsx)("button",{type:"button",className:"vr-account-actions__btn",onClick:async()=>{let s=`${window.location.origin}/profile`;await i.supabase.auth.resetPasswordForEmail(e.email,{redirectTo:s}),alert("Reset email sent.")},children:"Forgot Password (send email)"}),(0,s.jsx)("button",{type:"button",className:"vr-account-actions__btn vr-account-actions__btn--danger",onClick:el,children:"Delete My Data (collections)"}),Z&&(0,s.jsx)("p",{className:"vr-auth__message",children:Z})]})]}),(0,s.jsxs)("section",{className:"vr-category vr-category--profile vr-card",children:[(0,s.jsx)("h2",{className:"vr-category__title",children:"Newsletter Preferences"}),z?J?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"You are currently subscribed to our newsletter."}),(0,s.jsx)("button",{type:"button",className:"vr-account-actions__btn vr-account-actions__btn--danger",onClick:er,children:"Unsubscribe from Newsletter"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{children:"Youâ€™re not subscribed. Enter your email to subscribe:"}),(0,s.jsxs)("form",{className:"vr-auth__form vr-auth__form--inline",onSubmit:en,children:[(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Email"}),(0,s.jsx)("input",{type:"email",required:!0,value:W,onChange:e=>G(e.target.value),placeholder:"Enter your email"})]}),(0,s.jsx)("button",{className:"vr-auth__submit",type:"submit",children:"Subscribe"})]}),Q&&(0,s.jsx)("p",{className:"vr-auth__message",children:Q})]}):(0,s.jsx)("p",{children:"Checking subscriptionâ€¦"})]})]}),(0,s.jsx)(h.default,{})]})]}):(0,s.jsxs)("div",{className:"vr-page",children:[(0,s.jsx)(t.default,{children:(0,s.jsxs)("title",{children:[d.BRAND_NAME," â€” Profile"]})}),(0,s.jsxs)("div",{className:"vr-auth",children:[(0,s.jsxs)("h1",{className:"vr-page__title",children:["Your ",d.BRAND_NAME," Profile"]}),(0,s.jsx)("p",{className:"vr-page__subtitle",children:"Sign in to save recipes, create categories, and more."}),(0,s.jsx)("div",{className:"vr-auth__tabs",children:["signin","signup","forgot"].map(e=>(0,s.jsxs)("button",{className:`vr-auth__tab ${g===e?"vr-auth__tab--active":""}`,onClick:()=>v(e),children:["signin"===e&&"Sign In","signup"===e&&"Sign Up","forgot"===e&&"Forgot Password"]},e))}),(0,s.jsxs)("form",{className:"vr-auth__form",onSubmit:"signin"===g?es:"signup"===g?ea:et,children:[(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Email"}),(0,s.jsx)("input",{type:"email",required:!0,value:_,onChange:e=>f(e.target.value)})]}),"signup"===g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"First Name"}),(0,s.jsx)("input",{type:"text",required:!0,value:N,onChange:e=>w(e.target.value)})]}),(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Last Name"}),(0,s.jsx)("input",{type:"text",required:!0,value:S,onChange:e=>C(e.target.value)})]}),(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Phone Number"}),(0,s.jsx)("input",{type:"tel",required:!0,value:P,onChange:e=>A(e.target.value)})]})]}),"forgot"!==g&&(0,s.jsxs)("label",{className:"vr-auth__field",children:[(0,s.jsx)("span",{children:"Password"}),(0,s.jsx)("input",{type:"password",required:!0,value:j,onChange:e=>x(e.target.value)})]}),(0,s.jsx)("button",{className:"vr-auth__submit",type:"submit",children:"signin"===g?"Sign In":"signup"===g?"Create Account":"Send Reset Email"}),b&&(0,s.jsx)("p",{className:"vr-auth__message",children:b})]})]})]})}e.s(["default",()=>g],94118)},54316,(e,s,a)=>{let t="/profile";(window.__NEXT_P=window.__NEXT_P||[]).push([t,()=>e.r(94118)]),s.hot&&s.hot.dispose(function(){window.__NEXT_P.push([t])})},48761,e=>{e.v(s=>Promise.all(["static/chunks/f4fe8aeb8343dcd3.js"].map(s=>e.l(s))).then(()=>s(93594)))},28805,e=>{e.v(s=>Promise.all(["static/chunks/3dcc93bb4829c1ba.js"].map(s=>e.l(s))).then(()=>s(79466)))}]);